apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/restartedAt: "2025-09-12T12:14:36Z"
  creationTimestamp: "2025-09-12T12:15:37Z"
  generateName: otcs-frontend-
  labels:
    app.kubernetes.io/component: otcs-frontend
    app.kubernetes.io/instance: myrelease
    controller-revision-hash: otcs-frontend-5f54776889
    statefulset.kubernetes.io/pod-name: otcs-frontend-0
  name: otcs-frontend-0
  namespace: ecm
  ownerReferences:
  - apiVersion: apps/v1
    blockOwnerDeletion: true
    controller: true
    kind: StatefulSet
    name: otcs-frontend
    uid: 6d0cbe52-2777-4eaa-80c2-dc03b55cd7a7
  resourceVersion: "282666"
  uid: 446330d9-a2f0-4dd1-9892-e3f2dead489e
spec:
  containers:
  - command:
    - sh
    - -c
    - until [ "$(curl -s -w '%{http_code}' -o /dev/null http://localhost:8000/readyz)"
      -eq 200 ]; do echo "Waiting for Kubernetes API to be ready"; sleep 10; done;
      /usr/bin/supervisord -c /etc/supervisor/conf.d/supervisord.conf
    env:
    - name: OTCS_BACKEND_SEARCH_REPLICAS
      value: "1"
    - name: OTCS_FRONTEND_REPLICAS
      value: "1"
    - name: OTCS_TYPE
      value: secondary
    - name: OTCS_CONTAINER_LOG_LEVEL
      value: DEBUG
    - name: OTCS_ROLE
      value: frontend
    - name: OTDS_SERVICE_NAME
      value: otds
    - name: SHARED_ADDRESS_SPACE_NAT
      value: "false"
    - name: TZ
      value: Asia/Seoul
    - name: PGHOST
      value: ecmsvr25
    - name: PGPORT
      value: "5432"
    - name: PGUSER
      value: postgres
    - name: PGDATABASE
      value: postgres
    - name: MAX_THREAD_LIFESPAN
      value: "10"
    - name: OTXECM_SECRET_NAME
      value: otxecm-default-secrets
    - name: UALEnabled
      value: "false"
    - name: RESTART_AUTOMATION_TIME
      value: "60"
    image: registry.opentext.com/otxecm:25.3.0
    imagePullPolicy: IfNotPresent
    livenessProbe:
      exec:
        command:
        - /opt/opentext/container_files/bash/check_cs_liveness.sh
      failureThreshold: 3
      initialDelaySeconds: 600
      periodSeconds: 30
      successThreshold: 1
      timeoutSeconds: 15
    name: otcs-frontend-container
    ports:
    - containerPort: 2099
      protocol: TCP
    - containerPort: 8080
      protocol: TCP
    readinessProbe:
      exec:
        command:
        - /opt/opentext/container_files/bash/check_cs_readiness.sh
      failureThreshold: 3
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 6
    resources: {}
    securityContext:
      allowPrivilegeEscalation: false
      runAsNonRoot: true
    terminationMessagePath: /dev/termination-log
    terminationMessagePolicy: File
    volumeMounts:
    - mountPath: /opt/opentext/extensions
      name: extensions-volume-mount
    - mountPath: /opt/opentext/cs_persist
      name: cs-persist
    - mountPath: /opt/opentext/multifile
      name: otcs-multifile
    - mountPath: /opt/opentext/cs/logs
      name: logs
    - mountPath: /opt/opentext/sftp
      name: sftp-volume
    - mountPath: /opt/opentext/container_files/custom_config/config.yaml
      name: config
      subPath: config.yaml
    - mountPath: /opt/opentext/container_files/custom_config/sp.pem
      name: otcs-archive-cert-configmap
      subPath: sp.pem
    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
      name: kube-api-access-f7bht
      readOnly: true
  - args:
    - |
      kubectl proxy --port=8000 --address=127.0.0.1 &
      kubectl proxy --port=8000 --address=[::1] &
      wait
    command:
    - sh
    - -c
    image: docker.io/bitnami/kubectl:1.30.4
    imagePullPolicy: IfNotPresent
    name: kubectl-proxy
    ports:
    - containerPort: 8000
      protocol: TCP
    resources: {}
    terminationMessagePath: /dev/termination-log
    terminationMessagePolicy: File
    volumeMounts:
    - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
      name: kube-api-access-f7bht
      readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  hostname: otcs-frontend-0
  imagePullSecrets:
  - name: regcred
  nodeName: ecm-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 900
  priorityClassName: myrelease-ecm-2
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext:
    fsGroup: 1000
    fsGroupChangePolicy: OnRootMismatch
    runAsUser: 1000
  serviceAccount: otxecm-sa
  serviceAccountName: otxecm-sa
  subdomain: otcs-frontend
  terminationGracePeriodSeconds: 60
  tolerations:
  - effect: NoExecute
    key: node.kubernetes.io/not-ready
    operator: Exists
    tolerationSeconds: 300
  - effect: NoExecute
    key: node.kubernetes.io/unreachable
    operator: Exists
    tolerationSeconds: 300
  volumes:
  - name: cs-persist
    persistentVolumeClaim:
      claimName: cs-persist-otcs-frontend-0
  - name: logs
    persistentVolumeClaim:
      claimName: logs-otcs-frontend-0
  - emptyDir: {}
    name: extensions-volume-mount
  - configMap:
      defaultMode: 420
      name: otcs-frontend-configmap
    name: config
  - configMap:
      defaultMode: 420
      name: otcs-archive-cert-configmap
    name: otcs-archive-cert-configmap
  - name: sftp-volume
    persistentVolumeClaim:
      claimName: sftp-volume
  - emptyDir:
      sizeLimit: 10Gi
    name: otcs-multifile
  - name: kube-api-access-f7bht
    projected:
      defaultMode: 420
      sources:
      - serviceAccountToken:
          expirationSeconds: 3607
          path: token
      - configMap:
          items:
          - key: ca.crt
            path: ca.crt
          name: kube-root-ca.crt
      - downwardAPI:
          items:
          - fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
            path: namespace
status:
  conditions:
  - lastProbeTime: null
    lastTransitionTime: "2025-09-12T12:15:37Z"
    status: "True"
    type: Initialized
  - lastProbeTime: null
    lastTransitionTime: "2025-09-12T12:45:21Z"
    status: "True"
    type: Ready
  - lastProbeTime: null
    lastTransitionTime: "2025-09-12T12:45:21Z"
    status: "True"
    type: ContainersReady
  - lastProbeTime: null
    lastTransitionTime: "2025-09-12T12:15:37Z"
    status: "True"
    type: PodScheduled
  containerStatuses:
  - containerID: containerd://e2dfaf37ffb4f73a6a6a4b9f8fb287b244b66e94a978b2e1149824657b70d826
    image: docker.io/bitnami/kubectl:1.30.4
    imageID: docker.io/bitnami/kubectl@sha256:6223d1c0c55819ee837a89982b56f0e0c2872f8e4785862c7e8e920e7a527957
    lastState: {}
    name: kubectl-proxy
    ready: true
    restartCount: 0
    started: true
    state:
      running:
        startedAt: "2025-09-12T12:15:38Z"
  - containerID: containerd://650a4fa6bfb0e960c78e22ee39e7d63ffb04607091b18231190f3a9800c34d38
    image: registry.opentext.com/otxecm:25.3.0
    imageID: registry.opentext.com/otxecm@sha256:47c24d786579568ce8c7e9083752c547ba0110b4eeb8b322b9e86bd9d89f7b2d
    lastState: {}
    name: otcs-frontend-container
    ready: true
    restartCount: 0
    started: true
    state:
      running:
        startedAt: "2025-09-12T12:15:38Z"
  hostIP: 172.18.0.2
  phase: Running
  podIP: 10.244.0.36
  podIPs:
  - ip: 10.244.0.36
  qosClass: BestEffort
  startTime: "2025-09-12T12:15:37Z"
