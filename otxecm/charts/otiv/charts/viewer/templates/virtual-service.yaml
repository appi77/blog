{{- if or (include "is.ocp" .) .Values.global.istioVirtualServicesEnabled }}
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: {{ include "base.resource.name" . }}
  {{- template "metadata.namespace" . }}
spec:
  hosts:
    - {{ include "ingress.fqdn.viewer" .}}
    - {{ include "base.resource.name.svc" . }}
  gateways:
    - paas-apps/asm-gateway
    - mesh
  http:
    - route:
      - destination:
          host: {{ include "base.resource.name" . }}
{{- end }}
